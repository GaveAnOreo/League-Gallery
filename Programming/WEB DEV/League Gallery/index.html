<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>League Gallery</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --gold-accent: #cba25f;
        --blue-accent: #6cc1ff;
        --red-accent: #ff7b9b;
      }

      * {
        box-sizing: border-box;
      }

      body {
        background: radial-gradient(
          circle at top,
          #0f172a 0%,
          #030610 60%,
          #010308 100%
        );
        background-attachment: fixed;
        color: #e7ecf5;
        min-height: 100vh;
        font-family:
          "Segoe UI",
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
      }

      .champion-header {
        background: rgba(4, 7, 15, 0.9);
        border-bottom: 1px solid rgba(203, 162, 95, 0.3);
        position: sticky;
        top: 0;
        z-index: 60;
        backdrop-filter: blur(14px);
      }

      .champion-title {
        font-weight: 700;
        letter-spacing: 0.12em;
        color: var(--gold-accent);
        text-transform: uppercase;
      }

      .header-copy {
        color: #9aa5c2;
        margin-bottom: 0;
      }

      .crest-icon {
        width: 72px;
        height: 72px;
        fill: var(--gold-accent);
        filter: drop-shadow(0 0 12px rgba(203, 162, 95, 0.45));
      }

      .search-container {
        position: relative;
      }

      .search-icon {
        position: absolute;
        left: 1.25rem;
        top: 50%;
        transform: translateY(-50%);
        color: #7b859f;
        z-index: 2;
      }

      .search-box {
        background: rgba(6, 11, 21, 0.9);
        border: 1px solid rgba(98, 112, 138, 0.6);
        border-radius: 999px;
        color: #f6f8fc;
        padding-left: 3.1rem;
        height: 3.4rem;
      }

      .search-box:focus {
        background: rgba(6, 11, 21, 0.95);
        border-color: var(--gold-accent);
        box-shadow: 0 0 0 3px rgba(203, 162, 95, 0.25);
      }

      .search-box::placeholder {
        color: #6e7790;
      }

      .clear-btn {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: #6e7790;
        cursor: pointer;
        padding: 0.35rem;
        display: none;
      }

      .clear-btn.visible {
        display: block;
      }

      .filter-pill {
        padding: 0.5rem 1.3rem;
        border-radius: 999px;
        border: 2px solid transparent;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.08rem;
        cursor: pointer;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease,
          border-color 0.2s ease;
      }

      .filter-pill:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
      }

      .filter-pill.active {
        border-color: var(--gold-accent);
        box-shadow: 0 8px 22px rgba(203, 162, 95, 0.35);
      }

      .filter-theme[data-role="all"] {
        background: linear-gradient(135deg, #1b2134, #0a0f1b);
        color: #f6f8fc;
      }

      .filter-theme[data-role="Assassin"] {
        background: linear-gradient(135deg, #c0392b, #6f1810);
        color: #fff;
      }

      .filter-theme[data-role="Fighter"] {
        background: linear-gradient(135deg, #d35400, #823200);
        color: #fff;
      }

      .filter-theme[data-role="Mage"] {
        background: linear-gradient(135deg, #8e44ad, #4c2463);
        color: #fff;
      }

      .filter-theme[data-role="Marksman"] {
        background: linear-gradient(135deg, #f1c40f, #a77400);
        color: #1f1400;
      }

      .filter-theme[data-role="Support"] {
        background: linear-gradient(135deg, #16a085, #0b4f40);
        color: #fff;
      }

      .filter-theme[data-role="Tank"] {
        background: linear-gradient(135deg, #2980b9, #153f60);
        color: #fff;
      }

      .champion-count {
        font-size: 0.95rem;
        color: #98a4c0;
      }

      .sort-select {
        background: rgba(6, 11, 21, 0.9);
        border: 1px solid rgba(98, 112, 138, 0.6);
        border-radius: 0.75rem;
        color: #f6f8fc;
        padding: 0.6rem 1rem;
        cursor: pointer;
      }

      .sort-select:focus {
        border-color: var(--gold-accent);
        box-shadow: 0 0 0 2px rgba(203, 162, 95, 0.2);
        outline: none;
      }

      #champion-list {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 1.5rem;
      }

      .loading-slot {
        width: 100%;
        display: flex;
        justify-content: center;
      }

      .slot-card {
        position: relative;
        width: 100%;
        aspect-ratio: 3 / 4;
        border-radius: 1.5rem;
        padding: 0.85rem;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: linear-gradient(
          180deg,
          rgba(7, 9, 16, 0.9),
          rgba(0, 0, 0, 0.6)
        );
        cursor: pointer;
        transition:
          transform 0.35s ease,
          box-shadow 0.35s ease,
          border-color 0.35s ease;
      }

      .slot-card::after {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(
          circle at top,
          rgba(255, 255, 255, 0.12),
          transparent 55%
        );
        opacity: 0;
        transition: opacity 0.35s ease;
      }

      .slot-card:hover {
        transform: translateY(-12px) scale(1.02);
        border-color: rgba(255, 255, 255, 0.25);
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.55);
      }

      .slot-card:hover::after {
        opacity: 1;
      }

      .slot-art {
        position: absolute;
        inset: 0;
        border-radius: 1.1rem;
        overflow: hidden;
      }

      .slot-art::before {
        content: "";
        position: absolute;
        inset: -10%;
        background-image: var(--splash-image);
        background-size: cover;
        background-position: center top;
        filter: blur(22px) saturate(1.2) brightness(0.7);
        transform: scale(1.05);
        z-index: 0;
      }

      .slot-art img {
        position: relative;
        z-index: 1;
        width: 100%;
        height: 100%;
        object-fit: contain;
        object-position: center top;
        filter: saturate(1.1) contrast(1.05);
      }

      .slot-gradient {
        position: absolute;
        inset: 0;
        border-radius: 1.1rem;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.15) 10%,
          rgba(0, 0, 0, 0.88) 85%
        );
      }

      .slot-overlay {
        position: relative;
        z-index: 2;
        display: flex;
        flex-direction: column;
        height: 100%;
        padding: 0.75rem 0.9rem 0.55rem;
      }

      .slot-body {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        gap: 0.35rem;
        margin-bottom: 0.9rem;
      }

      .slot-title {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.18rem;
        color: #9fb0ce;
        margin-bottom: 0.1rem;
      }

      .slot-name {
        font-size: 1.1rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08rem;
        margin-bottom: 0.15rem;
      }

      .slot-indicator {
        display: inline-flex;
        justify-content: center;
        align-self: center;
        margin-top: auto;
        margin-bottom: 0;
        padding: 0.35rem 0.9rem;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        font-size: 0.7rem;
        letter-spacing: 0.12rem;
        text-transform: uppercase;
        color: #f6f8fc;
        background: rgba(7, 12, 21, 0.45);
        transition:
          border-color 0.2s ease,
          background 0.2s ease;
        cursor: pointer;
        font-weight: 600;
        text-decoration: none;
        background-clip: padding-box;
      }

      .slot-indicator:focus-visible {
        outline: 2px solid rgba(203, 162, 95, 0.9);
        outline-offset: 2px;
      }

      .slot-card:hover .slot-indicator {
        border-color: rgba(255, 255, 255, 0.45);
        background: rgba(12, 19, 32, 0.75);
      }

      .role-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.3rem 0.85rem;
        border-radius: 999px;
        font-size: 0.65rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08rem;
        margin: 0.15rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .role-theme[data-role="Assassin"] {
        background: rgba(192, 57, 43, 0.25);
        color: #ffb6a7;
      }

      .role-theme[data-role="Fighter"] {
        background: rgba(211, 84, 0, 0.25);
        color: #ffcfac;
      }

      .role-theme[data-role="Mage"] {
        background: rgba(142, 68, 173, 0.25);
        color: #e6c9ff;
      }

      .role-theme[data-role="Marksman"] {
        background: rgba(241, 196, 15, 0.25);
        color: #6b4d07;
      }

      .role-theme[data-role="Support"] {
        background: rgba(22, 160, 133, 0.25);
        color: #a7f2de;
      }

      .role-theme[data-role="Tank"] {
        background: rgba(41, 128, 185, 0.25);
        color: #c3e9ff;
      }

      .loading-slot[data-team="blue"] .slot-card {
        box-shadow: 0 18px 48px rgba(64, 146, 255, 0.25);
      }

      .loading-slot[data-team="red"] .slot-card {
        box-shadow: 0 18px 48px rgba(255, 118, 141, 0.22);
      }

      .back-to-top {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        background: linear-gradient(140deg, var(--gold-accent), #8e6a3a);
        color: #0b0803;
        font-size: 1.2rem;
        opacity: 0;
        visibility: hidden;
        transition: all 0.25s ease;
        box-shadow: 0 18px 38px rgba(0, 0, 0, 0.5);
        z-index: 80;
      }

      .back-to-top.visible {
        opacity: 1;
        visibility: visible;
      }

      .pagination-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-top: 2rem;
      }

      .page-btn {
        min-width: 44px;
        height: 44px;
        border-radius: 0.6rem;
        border: 1px solid rgba(103, 120, 148, 0.5);
        background: rgba(9, 14, 23, 0.9);
        color: #cbd4e6;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .page-btn:hover:not(:disabled) {
        border-color: var(--gold-accent);
        color: #f5d79b;
      }

      .page-btn.active {
        background: linear-gradient(135deg, var(--gold-accent), #8a6a3a);
        color: #0e0b05;
        border-color: transparent;
      }

      .page-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .page-info {
        color: #8892a2;
        font-size: 0.9rem;
      }

      .no-results {
        color: #8892a2;
      }

      .modal-content {
        background: radial-gradient(
          circle at top,
          rgba(8, 12, 22, 0.98),
          rgba(3, 5, 11, 0.98)
        );
        border: 1px solid rgba(203, 162, 95, 0.4);
        border-radius: 1.5rem;
        color: #f5f6fa;
      }

      .modal-header {
        border-bottom: 1px solid rgba(203, 162, 95, 0.25);
      }

      .modal-header .btn-close {
        filter: invert(1) grayscale(1);
      }

      .detail-section-title {
        text-transform: uppercase;
        letter-spacing: 0.12rem;
        font-size: 0.85rem;
        color: #c7d2f0;
      }

      .stat-bar {
        height: 10px;
        background: rgba(255, 255, 255, 0.12);
        border-radius: 999px;
        overflow: hidden;
      }

      .stat-fill {
        height: 100%;
        border-radius: 999px;
        background: linear-gradient(90deg, #f8d087, #c7a559);
      }

      .stat-meta {
        font-size: 0.8rem;
        letter-spacing: 0.08rem;
        color: #cbd4e6;
      }

      .detail-hero {
        border-radius: 1.25rem;
        overflow: hidden;
        border: 1px solid rgba(203, 162, 95, 0.25);
      }

      .detail-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.5rem;
      }

      .detail-card {
        background: rgba(9, 14, 24, 0.85);
        border-radius: 1rem;
        padding: 1.25rem;
        border: 1px solid rgba(203, 162, 95, 0.15);
      }

      .detail-description {
        color: #cbd4e6;
        font-size: 0.95rem;
        line-height: 1.7;
      }

      .mini-stat {
        background: rgba(255, 255, 255, 0.04);
        border-radius: 0.8rem;
        padding: 0.75rem 1rem;
        border: 1px solid rgba(203, 162, 95, 0.2);
      }

      .mini-stat-label {
        font-size: 0.75rem;
        letter-spacing: 0.08rem;
        text-transform: uppercase;
        color: #9aa6c5;
        margin-bottom: 0.25rem;
      }

      .mini-stat-value {
        font-size: 1.1rem;
        font-weight: 600;
        color: #f5f6fa;
      }

      @media (max-width: 1200px) {
        #champion-list {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
      }

      @media (max-width: 992px) {
        #champion-list {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      @media (max-width: 768px) {
        #champion-list {
          grid-template-columns: 1fr;
        }

        .filter-pill {
          padding: 0.4rem 0.9rem;
          font-size: 0.7rem;
        }
      }
    </style>
  </head>

  <body>
    <header class="champion-header py-3 mb-4">
      <div class="container">
        <div
          class="d-flex align-items-center justify-content-center gap-3 text-center text-md-start flex-md-row flex-column"
        >
          <svg class="crest-icon" viewBox="0 0 64 64" aria-hidden="true">
            <path
              d="M32 4L8 14v16c0 15.3 10.4 29.2 24 32 13.6-2.8 24-16.7 24-32V14L32 4zm0 6.4L48 18v11.2C48 41 40.6 52.4 32 55.4 23.4 52.4 16 41 16 29.2V18l16-7.6z"
            />
            <path d="M24 22h16v4H24zM24 30h16v4H24z" />
          </svg>
          <div>
            <h1 class="champion-title h2 mb-1">League Gallery</h1>
            <p class="header-copy">
              Assemble your lobby and preview every champion as though the match
              is about to begin.
            </p>
          </div>
        </div>
      </div>
    </header>

    <div class="container pb-5">
      <div class="row mb-4">
        <div class="col-12 col-lg-6 mx-auto">
          <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input
              type="text"
              id="search-input"
              class="form-control search-box"
              placeholder="Search champions or epithets"
            />
            <button
              class="clear-btn"
              id="clear-search"
              type="button"
              aria-label="Clear search"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="row mb-4">
        <div class="col-12 text-center">
          <div
            class="d-flex flex-wrap justify-content-center gap-2"
            id="role-filters"
          ></div>
        </div>
      </div>

      <div class="row mb-4 align-items-center">
        <div class="col-12 col-md-6 text-center text-md-start mb-2 mb-md-0">
          <span class="champion-count" id="champion-count"></span>
        </div>
        <div class="col-12 col-md-6 text-center text-md-end">
          <select
            class="sort-select"
            id="sort-select"
            aria-label="Sort champions"
          >
            <option value="name-asc">Name (A-Z)</option>
            <option value="name-desc">Name (Z-A)</option>
            <option value="difficulty-desc">Difficulty (High to Low)</option>
            <option value="difficulty-asc">Difficulty (Low to High)</option>
          </select>
        </div>
      </div>

      <div id="champion-list"></div>

      <div class="pagination-container" id="pagination"></div>
    </div>

    <button class="back-to-top" id="back-to-top" aria-label="Back to top">
      <i class="fas fa-chevron-up"></i>
    </button>

    <div
      class="modal fade"
      id="champion-modal"
      tabindex="-1"
      aria-labelledby="champion-modal-title"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="champion-modal-title"></h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="champion-modal-body"></div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      (() => {
        const CHAMPIONS_PER_PAGE = 24;
        const ROLES = [
          "all",
          "Assassin",
          "Fighter",
          "Mage",
          "Marksman",
          "Support",
          "Tank",
        ];

        const state = {
          champions: [],
          currentRole: "all",
          currentSearch: "",
          currentSort: "name-asc",
          currentPage: 1,
          version: "",
          loadingMeta: new Map(),
        };

        const elements = {
          championList: document.getElementById("champion-list"),
          searchInput: document.getElementById("search-input"),
          clearSearch: document.getElementById("clear-search"),
          roleFilters: document.getElementById("role-filters"),
          championCount: document.getElementById("champion-count"),
          sortSelect: document.getElementById("sort-select"),
          backToTop: document.getElementById("back-to-top"),
          pagination: document.getElementById("pagination"),
          modalElement: document.getElementById("champion-modal"),
          modalTitle: document.getElementById("champion-modal-title"),
          modalBody: document.getElementById("champion-modal-body"),
        };

        const championModal = new bootstrap.Modal(elements.modalElement);

        const escapeHtml = (value = "") =>
          String(value).replace(
            /[&<>"']/g,
            (char) =>
              ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;",
              })[char],
          );

        const formatNumber = (value, decimals = 0) =>
          typeof value === "number" ? value.toFixed(decimals) : value;

        const emphasizeThe = (text = "") =>
          text.replace(
            /\bthe\b/gi,
            (match) => `T${match.slice(1).toLowerCase()}`,
          );

        const getSplashUrl = (champion) =>
          `https://ddragon.leagueoflegends.com/cdn/img/champion/splash/${champion.id}_0.jpg`;

        const getLoadingMeta = (championId) => {
          if (state.loadingMeta.has(championId)) {
            return state.loadingMeta.get(championId);
          }
          const meta = {
            team: Math.random() > 0.5 ? "blue" : "red",
          };
          state.loadingMeta.set(championId, meta);
          return meta;
        };
        const buildRoleBadges = (tags) =>
          tags
            .map((tag) => {
              const safeTag = escapeHtml(tag);
              return `<span class="role-badge role-theme" data-role="${safeTag}">${safeTag}</span>`;
            })
            .join("");

        const buildPowerProfile = (info = {}) => {
          const stats = [
            { label: "Attack", value: info.attack },
            { label: "Defense", value: info.defense },
            { label: "Magic", value: info.magic },
            { label: "Difficulty", value: info.difficulty },
          ];
          return stats
            .map(({ label, value = 0 }) => {
              const safeLabel = escapeHtml(label);
              const safeValue = Number(value) || 0;
              const percent = Math.max(
                0,
                Math.min(100, (safeValue / 10) * 100),
              );
              return `
                        <div class="mb-3">
                            <div class="d-flex justify-content-between stat-meta mb-1">
                                <span>${safeLabel}</span>
                                <span>${safeValue}/10</span>
                            </div>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: ${percent}%;"></div>
                            </div>
                        </div>
                    `;
            })
            .join("");
        };

        const buildBaseStats = (stats = {}) => {
          const entries = [
            { label: "HP", value: formatNumber(stats.hp, 0) },
            { label: "MP", value: formatNumber(stats.mp, 0) },
            { label: "Armor", value: formatNumber(stats.armor, 0) },
            { label: "MR", value: formatNumber(stats.spellblock, 0) },
            {
              label: "Attack Damage",
              value: formatNumber(stats.attackdamage, 0),
            },
            {
              label: "Attack Speed",
              value: formatNumber(stats.attackspeed, 2),
            },
          ];

          return `
                    <div class="row g-3">
                        ${entries
                          .map(
                            ({ label, value }) => `
                            <div class="col-6">
                                <div class="mini-stat h-100">
                                    <p class="mini-stat-label mb-1">${escapeHtml(label)}</p>
                                    <p class="mini-stat-value mb-0">${escapeHtml(String(value ?? "â€”"))}</p>
                                </div>
                            </div>
                        `,
                          )
                          .join("")}
                    </div>
                `;
        };

        const buildDetailContent = (champion) => {
          const safeName = escapeHtml(champion.name);
          const safeTitle = escapeHtml(emphasizeThe(champion.title));
          const safeBlurb = escapeHtml(
            champion.blurb || "No lore available right now.",
          ).replace(/\n/g, "<br>");
          const roles = buildRoleBadges(champion.tags);
          const splash = getSplashUrl(champion);

          return `
                    <div class="detail-hero mb-4">
                        <img src="${splash}" alt="${safeName} splash art" class="w-100" loading="lazy">
                    </div>
                    <div class="detail-grid">
                        <section class="detail-card">
                            <p class="detail-section-title mb-2">${safeTitle}</p>
                            <h2 class="mb-3">${safeName}</h2>
                            <p class="detail-description mb-4">${safeBlurb}</p>
                            <div class="d-flex flex-wrap gap-2">${roles}</div>
                        </section>
                        <section class="detail-card">
                            <p class="detail-section-title mb-3">Power profile</p>
                            ${buildPowerProfile(champion.info)}
                        </section>
                        <section class="detail-card">
                            <p class="detail-section-title mb-3">Base stats</p>
                            ${buildBaseStats(champion.stats)}
                        </section>
                    </div>
                `;
        };

        const showChampionDetail = (champion) => {
          if (!champion) return;
          const emphasizedTitle = emphasizeThe(champion.title);
          elements.modalTitle.textContent = `${champion.name} - ${emphasizedTitle}`;
          elements.modalBody.innerHTML = buildDetailContent(champion);
          championModal.show();
        };

        const getChampionFromElement = (element) => {
          const container = element?.closest("[data-champion-id]");
          if (!container) return null;
          const { championId } = container.dataset;
          return state.champions.find(({ id }) => id === championId);
        };

        const handleChampionView = (sourceElement) => {
          const champion = getChampionFromElement(sourceElement);
          showChampionDetail(champion);
        };
        const createCard = (champion) => {
          const safeName = escapeHtml(champion.name);
          const safeTitle = escapeHtml(champion.title);
          const roles = buildRoleBadges(champion.tags);
          const splash = getSplashUrl(champion);
          const { team } = getLoadingMeta(champion.id);

          return `
                    <div class="loading-slot" data-team="${team}">
                        <article class="slot-card" role="button" tabindex="0" data-champion-id="${champion.id}" aria-label="Preview ${safeName} details">
                            <div class="slot-art" style="--splash-image: url('${splash}');">
                                <img src="${splash}" alt="${safeName} splash art" loading="lazy">
                            </div>
                            <div class="slot-gradient"></div>
                            <div class="slot-overlay">
                                <div class="slot-body">
                                    <p class="slot-title">${safeTitle}</p>
                                    <h3 class="slot-name">${safeName}</h3>
                                    <div>${roles}</div>
                                </div>
                                <button type="button" class="slot-indicator" data-champion-id="${champion.id}" aria-label="View details for ${safeName}">View details</button>
                            </div>
                        </article>
                    </div>
                `;
        };

        const createRoleFilters = () => {
          elements.roleFilters.innerHTML = ROLES.map(
            (role) => `
                    <button type=\"button\" class=\"filter-pill filter-theme ${role === state.currentRole ? "active" : ""}\"
                        data-role-filter=\"${role}\" data-role=\"${role}\">
                        ${role}
                    </button>
                `,
          ).join("");
        };

        const updateRoleFilterActive = (selectedRole) => {
          elements.roleFilters
            .querySelectorAll(".filter-pill")
            .forEach((button) => {
              button.classList.toggle(
                "active",
                button.dataset.roleFilter === selectedRole,
              );
            });
        };

        const sortChampions = (champions) => {
          const sorted = [...champions];
          switch (state.currentSort) {
            case "name-desc":
              return sorted.sort((a, b) => b.name.localeCompare(a.name));
            case "difficulty-desc":
              return sorted.sort(
                (a, b) => b.info.difficulty - a.info.difficulty,
              );
              case "difficulty-asc":
                return sorted.sort((a, b) => a.info.difficulty - b.info.difficulty);
            case "name-asc":
            default:
              return sorted.sort((a, b) => a.name.localeCompare(b.name));
          }
        };

        const getFilteredChampions = () => {
          let filtered = state.champions;

          if (state.currentRole !== "all") {
            filtered = filtered.filter(({ tags }) =>
              tags.includes(state.currentRole),
            );
          }

          if (state.currentSearch) {
            const search = state.currentSearch.toLowerCase();
            filtered = filtered.filter(
              ({ name, title }) =>
                name.toLowerCase().includes(search) ||
                title.toLowerCase().includes(search),
            );
          }

          return sortChampions(filtered);
        };

        const updateChampionCount = (start, end, total) => {
          if (!total) {
            elements.championCount.textContent = "No champions found.";
            return;
          }
          elements.championCount.innerHTML = `Displaying <strong>${start}-${end}</strong> of <strong>${total}</strong> champions in lobby`;
        };

        const showNoResults = () => {
          elements.championList.innerHTML = `
                    <div class=\"w-100 text-center py-5\">
                        <i class=\"fas fa-search fa-3x text-secondary mb-3\"></i>
                        <p class=\"no-results h5\">No champions match those filters.</p>
                        <button class=\"btn btn-outline-warning mt-3\" type=\"button\" data-reset-filters>Reset Filters</button>
                    </div>
                `;
        };

        const renderChampions = () => {
          const filtered = getFilteredChampions();
          const total = filtered.length;

          if (total === 0) {
            updateChampionCount(0, 0, 0);
            showNoResults();
            elements.pagination.innerHTML = "";
            return;
          }

          const totalPages = Math.ceil(total / CHAMPIONS_PER_PAGE);
          if (state.currentPage > totalPages) {
            state.currentPage = 1;
          }

          const startIndex = (state.currentPage - 1) * CHAMPIONS_PER_PAGE;
          const endIndex = Math.min(startIndex + CHAMPIONS_PER_PAGE, total);
          const pageItems = filtered.slice(startIndex, endIndex);

          updateChampionCount(startIndex + 1, endIndex, total);
          elements.championList.innerHTML = pageItems.map(createCard).join("");
          renderPagination(totalPages);
        };

        const renderPagination = (totalPages) => {
          if (totalPages <= 1) {
            elements.pagination.innerHTML = "";
            return;
          }

          const { currentPage } = state;
          const maxVisible = 5;
          let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
          let endPage = Math.min(totalPages, startPage + maxVisible - 1);

          if (endPage - startPage + 1 < maxVisible) {
            startPage = Math.max(1, endPage - maxVisible + 1);
          }

          const parts = [];
          parts.push(`
                    <button class=\"page-btn\" data-page=\"${currentPage - 1}\" ${currentPage === 1 ? "disabled" : ""} aria-label=\"Previous page\">
                        <i class=\"fas fa-chevron-left\"></i>
                    </button>
                `);

          if (startPage > 1) {
            parts.push('<button class=\"page-btn\" data-page=\"1\">1</button>');
            if (startPage > 2) {
              parts.push('<span class=\"page-info\">...</span>');
            }
          }

          for (let page = startPage; page <= endPage; page += 1) {
            parts.push(`
                        <button class=\"page-btn ${page === currentPage ? "active" : ""}\" data-page=\"${page}\">
                            ${page}
                        </button>
                    `);
          }

          if (endPage < totalPages) {
            if (endPage < totalPages - 1) {
              parts.push('<span class=\"page-info\">...</span>');
            }
            parts.push(
              `<button class=\"page-btn\" data-page=\"${totalPages}\">${totalPages}</button>`,
            );
          }

          parts.push(`
                    <button class=\"page-btn\" data-page=\"${currentPage + 1}\" ${currentPage === totalPages ? "disabled" : ""} aria-label=\"Next page\">
                        <i class=\"fas fa-chevron-right\"></i>
                    </button>
                `);

          elements.pagination.innerHTML = parts.join("");
        };

        const goToPage = (page) => {
          const totalItems = getFilteredChampions().length;
          const totalPages = totalItems
            ? Math.ceil(totalItems / CHAMPIONS_PER_PAGE)
            : 0;
          if (page < 1 || page > totalPages) return;
          state.currentPage = page;
          renderChampions();
          elements.championList.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });
        };

        const resetFilters = () => {
          state.currentRole = "all";
          state.currentSearch = "";
          state.currentPage = 1;
          elements.searchInput.value = "";
          elements.clearSearch.classList.remove("visible");
          updateRoleFilterActive("all");
          renderChampions();
          elements.searchInput.focus();
        };

        const showLoadingState = () => {
          elements.championList.innerHTML = `
                    <div class=\"w-100 text-center py-5\">
                        <div class=\"spinner-border text-warning mb-3\" role=\"status\" style=\"width: 4rem; height: 4rem;\"></div>
                        <p class=\"h5 text-warning\">Syncing champion roster...</p>
                    </div>
                `;
          elements.pagination.innerHTML = "";
          elements.championCount.textContent = "Fetching champion data...";
        };

        const loadChampions = async () => {
          showLoadingState();
          try {
            const versionsResponse = await fetch(
              "https://ddragon.leagueoflegends.com/api/versions.json",
            );
            if (!versionsResponse.ok) throw new Error("Version lookup failed");
            const versions = await versionsResponse.json();
            const latestVersion = versions[0];

            const championResponse = await fetch(
              `https://ddragon.leagueoflegends.com/cdn/${latestVersion}/data/en_US/champion.json`,
            );
            if (!championResponse.ok)
              throw new Error("Champion data failed to load");
            const championData = await championResponse.json();

            state.version = latestVersion;
            state.loadingMeta = new Map();
            state.champions = Object.values(championData.data).sort((a, b) =>
              a.name.localeCompare(b.name),
            );
            renderChampions();
          } catch (error) {
            console.error("Error loading champions:", error);
            elements.championList.innerHTML = `
                        <div class=\"w-100 text-center py-5\">
                            <p class=\"text-danger h5\">Unable to load champion data. Please try again later.</p>
                        </div>
                    `;
            elements.championCount.textContent = "Champion data unavailable.";
          }
        };

        const bindEvents = () => {
          elements.roleFilters.addEventListener("click", (event) => {
            const button = event.target.closest("[data-role-filter]");
            if (!button) return;
            state.currentRole = button.dataset.roleFilter;
            state.currentPage = 1;
            updateRoleFilterActive(state.currentRole);
            renderChampions();
          });

          let searchTimeout = null;
          elements.searchInput.addEventListener("input", (event) => {
            const value = event.target.value.trim();
            elements.clearSearch.classList.toggle("visible", value.length > 0);
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
              state.currentSearch = value;
              state.currentPage = 1;
              renderChampions();
            }, 250);
          });

          elements.clearSearch.addEventListener("click", () => {
            resetFilters();
          });

          elements.sortSelect.addEventListener("change", (event) => {
            state.currentSort = event.target.value;
            state.currentPage = 1;
            renderChampions();
          });

          window.addEventListener("scroll", () => {
            elements.backToTop.classList.toggle(
              "visible",
              window.scrollY > 400,
            );
          });

          elements.backToTop.addEventListener("click", () => {
            window.scrollTo({ top: 0, behavior: "smooth" });
          });

          elements.championList.addEventListener("click", (event) => {
            if (event.target.closest("[data-reset-filters]")) {
              resetFilters();
              return;
            }
            const indicator = event.target.closest(".slot-indicator");
            if (indicator) {
              handleChampionView(indicator);
            }
          });

          elements.championList.addEventListener("keydown", (event) => {
            const card = event.target.closest(".slot-card");
            if (!card) return;
            if (event.key === "Enter" || event.key === " ") {
              event.preventDefault();
              handleChampionView(card);
            }
          });

          elements.pagination.addEventListener("click", (event) => {
            const button = event.target.closest("[data-page]");
            if (!button || button.disabled) return;
            const targetPage = Number(button.dataset.page);
            if (!Number.isNaN(targetPage)) {
              goToPage(targetPage);
            }
          });
        };

        const init = () => {
          createRoleFilters();
          bindEvents();
          loadChampions();
        };

        init();
      })();
    </script>
  </body>
</html>